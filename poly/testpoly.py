import numpy as np


class LagrangePoly:

    def __init__(self, X, Y):
        self.n = len(X)
        self.X = np.array(X)
        self.Y = np.array(Y)

    def basis(self, x, j):
        b = [(x - self.X[m]) / (self.X[j] - self.X[m])
             for m in range(self.n) if m != j]
        # print(j, b)
        return np.prod(b, axis=0) * self.Y[j]

    def interpolate(self, x):
        b = [self.basis(x, j) for j in range(self.n)]
        # print(b)
        return np.sum(b, axis=0)


# X  = [-9, -4, -1, 7]
# Y  = [5, 2, -2, 9]

X  = [0, 1, 4]
Y  = [-1,1, 1]

# Y = [-22149909347740373410356864778320542770428683051126159404695384578842190449086402726680811087237850434222571945975319243521190339628583028791306130323553,
#  -221349205294168105687714974951653325190519489628792868294140931574549605011895656810512338582453662321277267509304779746993403410237762775056314399904336,
#  -2789860824231089295046101963672168533350592716391016757637065660876691954939292357301552639063473613824761250403919870848536644863144001403886766303799635,
#  -17125449556786800005112572028405621002180063242353967181489240492941597041290682624764500956719337047497619802402490986423323723980233379909811190918856076,
#  -66170056935976098432776079427593979395965479010232058747387589492697727175196886377263717006270758228355512569866959095497054469217671646256341415654412061,
#  -192732187371580360264827635292410608347097471016175323878728537389565592526181609059529729379976868734347219091555838359201326043517672177993491156103559568,
#  -465809294284527614034600464438515450594817703299506785377146357097477664470482913372125743954641959846825044326431518747729003259620263944875294605894405951, 
#  -986910166241272616478610162177810209123965822932459828984891517234898288939374691000614152298622224941015224181467568657289588895375059471477325026541335740,
#  -1896377313088176927893194851130193529303726410009915575947209029644843599767488134344723040078832501876488331039456037527064594009053022799814213337296272441,
#  -3379709352085888987491155338035316181026375927639140255574716796914901432041133208247512695467753015387629679286814758456162908254658237451957166704999940336,
#  -5673883394043724188758395270564336240846029671929522577805783959897251235446620121724542117550436119474109730841394650820576170197239674392651487133933126283]
# X = [0,1,2,3,4,5,6,7,8,9,10]

# plt.scatter(X, Y, c='k')

lp = LagrangePoly(X, Y)

# xx = np.arange(0, 10) / 10
# index=9
for i in range(0, len(X)):
    res=lp.interpolate(X[i]);
    print(i, res, Y[i], res-Y[i]==0)

print(lp.interpolate(5))